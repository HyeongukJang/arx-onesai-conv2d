#include <time.h>
#include <stdbool.h>
#include <string.h>

#ifdef RUN_ON_HOST_COMP
#include <stdlib.h>
#include "mnist_onnx.h"
#else
#include <ervp_fakefile.h>
#include <ervp_malloc.h>
#include "mnist_onnx.h"
#endif

int main(int argc, char** argv) {
    float input[784] = {0.6642, 0.6487, 0.6945, 0.6919, 0.2093, 0.7173, 0.4988, 0.2319, 0.0678, 0.9871, 0.7319, 0.0689, 0.6496, 0.3846, 0.6586, 0.8218, 0.4507, 0.2243, 0.6413, 0.6522, 0.3177, 0.1483, 0.2617, 0.4963, 0.5082, 0.2379, 0.4501, 0.2992, 0.8256, 0.8556, 0.1456, 0.6179, 0.4652, 0.3822, 0.2337, 0.9104, 0.9120, 0.9283, 0.6673, 0.1907, 0.0047, 0.7477, 0.7993, 0.9911, 0.7932, 0.3976, 0.3166, 0.7520, 0.9488, 0.7556, 0.8127, 0.5930, 0.6685, 0.2754, 0.0726, 0.6322, 0.1345, 0.0957, 0.5733, 0.1726, 0.1754, 0.9639, 0.7748, 0.8498, 0.5627, 0.5608, 0.1568, 0.6087, 0.4096, 0.4576, 0.3596, 0.9741, 0.9478, 0.2046, 0.3954, 0.3268, 0.9806, 0.3758, 0.3374, 0.6150, 0.6130, 0.0257, 0.7664, 0.4617, 0.6870, 0.7165, 0.3726, 0.1311, 0.9383, 0.3180, 0.3386, 0.9399, 0.7105, 0.2176, 0.9046, 0.8655, 0.8241, 0.4542, 0.0234, 0.9368, 0.2702, 0.6851, 0.6144, 0.6820, 0.0980, 0.0612, 0.6110, 0.6125, 0.5667, 0.5521, 0.4710, 0.9505, 0.6417, 0.1932, 0.0812, 0.7689, 0.7584, 0.0842, 0.7957, 0.7565, 0.3650, 0.7555, 0.6657, 0.9355, 0.9683, 0.8718, 0.5628, 0.1482, 0.9463, 0.3175, 0.3008, 0.1916, 0.7175, 0.7669, 
                        0.8113, 0.7923, 0.4998, 0.5100, 0.8140, 0.0093, 0.0135, 0.7672, 0.5388, 0.0315, 0.8295, 0.3573, 0.7953, 0.5691, 0.7666, 0.6413, 0.6155, 0.4023, 0.5430, 0.3526, 0.2985, 0.8109, 0.0368, 0.4987, 0.7074, 0.4584, 0.6378, 0.3495, 0.1430, 0.7491, 0.5184, 0.6381, 0.6092, 0.2885, 0.7255, 0.7632, 0.9222, 0.2546, 0.3536, 0.6674, 0.1488, 0.7258, 0.8705, 0.7439, 0.6671, 0.0684, 0.9956, 0.0484, 0.8881, 0.0897, 0.2303, 0.2778, 0.0111, 0.5007, 0.9456, 0.9292, 0.3104, 0.6298, 0.2810, 0.1472, 0.5027, 0.5551, 0.7376, 0.5020, 0.3175, 0.5053, 0.8934, 0.1747, 0.3450, 0.0964, 0.9455, 0.8795, 0.3450, 0.6123, 0.8540, 0.0123, 0.8095, 0.8240, 0.3744, 0.1911, 0.8256, 0.2850, 0.2108, 0.8792, 0.7274, 0.4145, 0.9679, 0.6201, 0.3581, 0.1163, 0.0215, 0.2649, 0.6648, 0.0219, 0.1094, 0.4595, 0.3635, 0.1275, 0.2458, 0.2274, 0.2797, 0.1147, 0.7603, 0.0176, 0.5457, 0.0713, 0.0461, 0.0539, 0.3595, 0.0547, 0.0894, 0.3475, 0.5694, 0.5010, 0.8656, 0.5567, 0.3544, 0.5015, 0.7450, 0.3579, 0.5214, 0.8033, 0.2151, 0.3698, 0.7517, 0.8784, 0.1281, 0.9604, 0.0641, 0.5153, 0.6562, 0.5415, 0.6063, 0.8246,
                        0.3918, 0.3886, 0.7335, 0.6538, 0.5536, 0.3438, 0.7999, 0.5964, 0.6795, 0.0793, 0.9857, 0.6861, 0.3071, 0.9238, 0.0754, 0.9331, 0.3390, 0.9817, 0.9749, 0.9973, 0.9337, 0.3144, 0.2251, 0.5781, 0.1145, 0.3370, 0.9790, 0.4511, 0.3838, 0.0902, 0.0043, 0.3478, 0.8577, 0.0135, 0.9770, 0.5855, 0.3286, 0.3094, 0.6977, 0.9819, 0.2005, 0.3677, 0.7232, 0.2764, 0.4680, 0.3645, 0.2625, 0.6248, 0.2617, 0.5696, 0.0686, 0.5361, 0.3610, 0.5588, 0.9788, 0.4041, 0.0583, 0.6928, 0.6199, 0.4554, 0.7215, 0.0436, 0.4481, 0.5225, 0.0613, 0.0265, 0.0235, 0.6685, 0.4776, 0.7157, 0.2583, 0.0966, 0.4807, 0.6726, 0.8933, 0.2836, 0.4732, 0.6831, 0.4251, 0.2723, 0.0629, 0.2873, 0.8862, 0.7226, 0.6740, 0.9762, 0.8822, 0.7160, 0.8764, 0.5287, 0.1881, 0.6408, 0.4724, 0.2919, 0.0317, 0.4807, 0.0898, 0.6200, 0.3822, 0.6707, 0.6070, 0.9005, 0.9037, 0.9305, 0.7784, 0.5605, 0.5547, 0.7410, 0.9109, 0.3538, 0.0235, 0.5023, 0.8802, 0.3525, 0.8234, 0.4331, 0.0840, 0.8382, 0.8888, 0.8011, 0.9885, 0.9775, 0.8727, 0.9608, 0.5395, 0.5898, 0.2462, 0.2208, 0.2564, 0.1410, 0.9301, 0.8830, 0.4797, 0.5427,
                        0.1615, 0.2049, 0.6658, 0.8253, 0.0678, 0.7266, 0.1672, 0.2440, 0.6898, 0.3690, 0.4532, 0.8874, 0.4553, 0.0973, 0.6120, 0.6641, 0.1604, 0.5907, 0.3484, 0.0147, 0.9842, 0.8640, 0.5453, 0.5583, 0.4490, 0.8503, 0.2555, 0.7845, 0.0982, 0.1597, 0.2661, 0.7179, 0.9254, 0.3359, 0.2262, 0.6078, 0.6966, 0.8535, 0.6951, 0.6863, 0.7619, 0.4427, 0.9085, 0.9865, 0.3441, 0.4793, 0.2208, 0.2437, 0.8061, 0.5281, 0.2206, 0.4192, 0.9263, 0.7415, 0.6037, 0.3154, 0.5352, 0.7402, 0.7844, 0.5966, 0.8896, 0.3224, 0.8371, 0.9200, 0.7934, 0.6214, 0.6828, 0.8209, 0.6416, 0.1993, 0.8662, 0.8907, 0.8070, 0.0795, 0.2971, 0.7267, 0.9787, 0.0300, 0.3066, 0.1670, 0.2286, 0.0615, 0.5581, 0.2222, 0.2627, 0.0152, 0.6573, 0.8957, 0.6843, 0.9604, 0.2329, 0.3155, 0.9691, 0.3253, 0.3108, 0.3027, 0.1671, 0.2396, 0.5949, 0.7499, 0.1335, 0.9184, 0.2006, 0.9659, 0.6665, 0.1226, 0.1689, 0.3259, 0.2041, 0.6543, 0.1232, 0.7092, 0.9050, 0.3387, 0.3787, 0.7079, 0.9678, 0.1337, 0.5438, 0.6540, 0.2366, 0.4558, 0.2286, 0.3508, 0.0224, 0.9148, 0.6431, 0.2976, 0.4897, 0.3420, 0.9370, 0.1491, 0.2919, 0.3014,
                        0.6042, 0.5901, 0.8332, 0.8899, 0.1859, 0.6950, 0.0280, 0.4893, 0.8070, 0.3929, 0.9560, 0.0538, 0.8558, 0.6501, 0.4919, 0.0020, 0.9230, 0.1980, 0.0312, 0.5554, 0.4161, 0.8585, 0.0689, 0.2498, 0.9370, 0.9447, 0.1599, 0.6105, 0.9110, 0.2188, 0.6083, 0.5309, 0.4096, 0.7683, 0.2202, 0.3956, 0.7706, 0.4526, 0.3511, 0.8550, 0.7071, 0.9606, 0.2028, 0.3152, 0.9095, 0.7744, 0.2500, 0.9956, 0.0256, 0.5443, 0.4704, 0.2552, 0.4877, 0.8685, 0.0736, 0.4142, 0.5948, 0.0301, 0.4739, 0.8916, 0.1934, 0.4775, 0.9496, 0.0849, 0.8692, 0.3810, 0.7337, 0.3144, 0.5102, 0.3936, 0.3857, 0.2730, 0.2835, 0.0079, 0.4248, 0.6415, 0.3251, 0.6169, 0.5899, 0.4973, 0.8736, 0.9431, 0.8314, 0.9128, 0.0121, 0.7370, 0.7558, 0.8192, 0.8937, 0.0388, 0.8359, 0.4188, 0.0341, 0.0741, 0.6330, 0.5484, 0.0691, 0.7299, 0.5518, 0.3238, 0.8663, 0.2663, 0.9305, 0.4732, 0.3426, 0.1721, 0.9365, 0.8133, 0.9861, 0.1411, 0.9321, 0.5352, 0.9761, 0.0903, 0.3256, 0.0288, 0.4491, 0.1854, 0.2744, 0.7946, 0.3067, 0.4591, 0.0841, 0.7340, 0.4137, 0.2870, 0.3006, 0.1720, 0.5795, 0.2084, 0.0073, 0.7345, 0.7455, 0.9174,
                        0.9161, 0.4594, 0.8974, 0.6324, 0.4392, 0.9679, 0.2227, 0.3926, 0.5413, 0.0307, 0.2746, 0.4021, 0.2514, 0.3127, 0.7482, 0.0391, 0.6697, 0.1585, 0.0304, 0.7827, 0.0120, 0.7035, 0.4363, 0.3680, 0.9805, 0.0269, 0.4801, 0.6528, 0.7004, 0.9348, 0.1492, 0.2885, 0.0552, 0.2567, 0.1570, 0.5794, 0.7738, 0.4176, 0.5678, 0.6627, 0.4226, 0.2120, 0.6681, 0.8535, 0.0097, 0.7948, 0.2247, 0.9263, 0.7369, 0.2783, 0.8521, 0.3220, 0.6662, 0.4990, 0.7477, 0.7807, 0.1589, 0.9219, 0.1785, 0.8489, 0.0772, 0.4017, 0.9975, 0.6778, 0.4028, 0.3468, 0.7965, 0.7299, 0.9247, 0.0524, 0.3510, 0.4960, 0.6966, 0.0876, 0.6574, 0.4471, 0.8806, 0.0014, 0.6151, 0.8059, 0.8461, 0.8189, 0.0364, 0.6321, 0.5908, 0.8541, 0.1066, 0.8110, 0.9150, 0.0513, 0.0458, 0.3258, 0.7162, 0.2887, 0.8827, 0.2934, 0.0012, 0.0725, 0.2484, 0.6345, 0.3677, 0.1412, 0.1895, 0.2281, 0.1631, 0.8685, 0.5753, 0.5944, 0.2412, 0.2883, 0.4175, 0.8655, 0.4398, 0.7073};
    float output[10];
    

    main_graph(input, output);

    for (int i = 0; i < 10; ++i) {
        printf("%.4f ", output[i]);
    }
    return 0;
}
